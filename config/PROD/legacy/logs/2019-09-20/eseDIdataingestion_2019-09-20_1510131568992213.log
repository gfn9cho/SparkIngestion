19/09/20 15:10:15 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
19/09/20 15:10:16 INFO RMProxy: Connecting to ResourceManager at ip-10-84-38-68.corp.stateauto.com/10.84.38.68:8032
19/09/20 15:10:16 INFO Client: Requesting a new application from cluster with 6 NodeManagers
19/09/20 15:10:16 INFO Client: Verifying our application has not requested more than the maximum memory capability of the cluster (122880 MB per container)
19/09/20 15:10:16 INFO Client: Will allocate AM container, with 22528 MB memory including 2048 MB overhead
19/09/20 15:10:16 INFO Client: Setting up container launch context for our AM
19/09/20 15:10:16 INFO Client: Setting up the launch environment for our AM container
19/09/20 15:10:16 INFO Client: Preparing resources for our AM container
19/09/20 15:10:16 WARN Client: Neither spark.yarn.jars nor spark.yarn.archive is set, falling back to uploading libraries under SPARK_HOME.
19/09/20 15:10:19 INFO Client: Uploading resource file:/mnt/tmp/spark-c6dccdd6-55bc-4e4d-84a5-764c2f6a4ebd/__spark_libs__5101519054905542153.zip -> hdfs://ip-10-84-38-68.corp.stateauto.com:8020/user/hadoop/.sparkStaging/application_1567696628598_9406/__spark_libs__5101519054905542153.zip
19/09/20 15:10:19 INFO Client: Uploading resource file:/home/hadoop/processed/jars/edf_dataingestion-assembly-2.0.0.jar -> hdfs://ip-10-84-38-68.corp.stateauto.com:8020/user/hadoop/.sparkStaging/application_1567696628598_9406/edf_dataingestion-assembly-2.0.0.jar
19/09/20 15:10:20 INFO Client: Uploading resource file:/home/hadoop/processed/ese/spec_files/ese_daily_DI.properties#diProperties.properties -> hdfs://ip-10-84-38-68.corp.stateauto.com:8020/user/hadoop/.sparkStaging/application_1567696628598_9406/ese_daily_DI.properties
19/09/20 15:10:20 INFO Client: Uploading resource file:/home/hadoop/processed/ese/spec_files/ese_lookup_info.csv#ese_lookup_info.csv -> hdfs://ip-10-84-38-68.corp.stateauto.com:8020/user/hadoop/.sparkStaging/application_1567696628598_9406/ese_lookup_info.csv
19/09/20 15:10:20 INFO Client: Uploading resource file:/home/hadoop/processed/ese/spec_files/ese_pii_spec.csv#ese_pii_spec.csv -> hdfs://ip-10-84-38-68.corp.stateauto.com:8020/user/hadoop/.sparkStaging/application_1567696628598_9406/ese_pii_spec.csv
19/09/20 15:10:20 INFO Client: Uploading resource file:/home/hadoop/processed/ese/spec_files/ese_table_spec_daily_DI.csv#ese_table_spec_daily_DI.csv -> hdfs://ip-10-84-38-68.corp.stateauto.com:8020/user/hadoop/.sparkStaging/application_1567696628598_9406/ese_table_spec_daily_DI.csv
19/09/20 15:10:20 INFO Client: Uploading resource file:/etc/spark/conf/hive-site.xml -> hdfs://ip-10-84-38-68.corp.stateauto.com:8020/user/hadoop/.sparkStaging/application_1567696628598_9406/hive-site.xml
19/09/20 15:10:20 INFO Client: Uploading resource file:/mnt/tmp/spark-c6dccdd6-55bc-4e4d-84a5-764c2f6a4ebd/__spark_conf__6760850764368558303.zip -> hdfs://ip-10-84-38-68.corp.stateauto.com:8020/user/hadoop/.sparkStaging/application_1567696628598_9406/__spark_conf__.zip
19/09/20 15:10:20 INFO SecurityManager: Changing view acls to: hadoop
19/09/20 15:10:20 INFO SecurityManager: Changing modify acls to: hadoop
19/09/20 15:10:20 INFO SecurityManager: Changing view acls groups to: 
19/09/20 15:10:20 INFO SecurityManager: Changing modify acls groups to: 
19/09/20 15:10:20 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(hadoop); groups with view permissions: Set(); users  with modify permissions: Set(hadoop); groups with modify permissions: Set()
19/09/20 15:10:21 INFO Client: Submitting application application_1567696628598_9406 to ResourceManager
19/09/20 15:10:21 INFO YarnClientImpl: Submitted application application_1567696628598_9406
19/09/20 15:10:22 INFO Client: Application report for application_1567696628598_9406 (state: ACCEPTED)
19/09/20 15:10:22 INFO Client: 
	 client token: N/A
	 diagnostics: AM container is launched, waiting for AM container to Register with RM
	 ApplicationMaster host: N/A
	 ApplicationMaster RPC port: -1
	 queue: default
	 start time: 1568992221714
	 final status: UNDEFINED
	 tracking URL: http://ip-10-84-38-68.corp.stateauto.com:20888/proxy/application_1567696628598_9406/
	 user: hadoop
19/09/20 15:10:23 INFO Client: Application report for application_1567696628598_9406 (state: ACCEPTED)
19/09/20 15:10:24 INFO Client: Application report for application_1567696628598_9406 (state: ACCEPTED)
19/09/20 15:10:25 INFO Client: Application report for application_1567696628598_9406 (state: ACCEPTED)
19/09/20 15:10:26 INFO Client: Application report for application_1567696628598_9406 (state: ACCEPTED)
19/09/20 15:10:27 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:27 INFO Client: 
	 client token: N/A
	 diagnostics: N/A
	 ApplicationMaster host: ip-10-84-34-237.corp.stateauto.com
	 ApplicationMaster RPC port: 33127
	 queue: default
	 start time: 1568992221714
	 final status: UNDEFINED
	 tracking URL: http://ip-10-84-38-68.corp.stateauto.com:20888/proxy/application_1567696628598_9406/
	 user: hadoop
19/09/20 15:10:28 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:29 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:30 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:31 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:32 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:33 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:34 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:35 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:36 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:37 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:38 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:39 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:40 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:41 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:42 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:43 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:44 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:45 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:46 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:47 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:48 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:49 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:50 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:51 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:52 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:53 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:54 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:55 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:56 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:57 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:58 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:10:59 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:00 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:01 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:02 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:03 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:04 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:05 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:06 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:07 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:08 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:09 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:10 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:11 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:12 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:13 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:14 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:15 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:16 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:17 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:18 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:19 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:20 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:21 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:22 INFO Client: Application report for application_1567696628598_9406 (state: ACCEPTED)
19/09/20 15:11:22 INFO Client: 
	 client token: N/A
	 diagnostics: [Fri Sep 20 15:11:22 +0000 2019] Application is Activated, waiting for resources to be assigned for AM.  Details : AM Partition = CORE ; Partition Resource = <memory:368640, vCores:48> ; Queue's Absolute capacity = 100.0 % ; Queue's Absolute used capacity = 0.0 % ; Queue's Absolute max capacity = 100.0 % ; 
	 ApplicationMaster host: N/A
	 ApplicationMaster RPC port: -1
	 queue: default
	 start time: 1568992221714
	 final status: UNDEFINED
	 tracking URL: http://ip-10-84-38-68.corp.stateauto.com:20888/proxy/application_1567696628598_9406/
	 user: hadoop
19/09/20 15:11:23 INFO Client: Application report for application_1567696628598_9406 (state: ACCEPTED)
19/09/20 15:11:24 INFO Client: Application report for application_1567696628598_9406 (state: ACCEPTED)
19/09/20 15:11:25 INFO Client: Application report for application_1567696628598_9406 (state: ACCEPTED)
19/09/20 15:11:26 INFO Client: Application report for application_1567696628598_9406 (state: ACCEPTED)
19/09/20 15:11:27 INFO Client: Application report for application_1567696628598_9406 (state: ACCEPTED)
19/09/20 15:11:28 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:28 INFO Client: 
	 client token: N/A
	 diagnostics: N/A
	 ApplicationMaster host: ip-10-84-44-254.corp.stateauto.com
	 ApplicationMaster RPC port: 36567
	 queue: default
	 start time: 1568992221714
	 final status: UNDEFINED
	 tracking URL: http://ip-10-84-38-68.corp.stateauto.com:20888/proxy/application_1567696628598_9406/
	 user: hadoop
19/09/20 15:11:29 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:30 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:31 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:32 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:33 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:34 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:35 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:36 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:37 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:38 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:39 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:40 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:41 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:42 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:43 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:44 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:45 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:46 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:47 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:48 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:49 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:50 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:51 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:52 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:53 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:54 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:55 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:56 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:57 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:58 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:11:59 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:00 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:01 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:02 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:03 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:04 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:05 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:06 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:07 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:08 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:09 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:10 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:11 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:12 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:13 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:14 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:15 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:16 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:17 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:18 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:19 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:20 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:21 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:22 INFO Client: Application report for application_1567696628598_9406 (state: RUNNING)
19/09/20 15:12:23 INFO Client: Application report for application_1567696628598_9406 (state: FINISHED)
19/09/20 15:12:23 INFO Client: 
	 client token: N/A
	 diagnostics: User class threw exception: java.lang.NullPointerException
	at java.lang.String.compareTo(String.java:1155)
	at scala.collection.immutable.StringLike$class.compare(StringLike.scala:74)
	at scala.collection.immutable.StringOps.compare(StringOps.scala:29)
	at scala.collection.immutable.StringOps.compare(StringOps.scala:29)
	at scala.math.Ordered$class.$less$eq(Ordered.scala:84)
	at scala.collection.immutable.StringOps.$less$eq(StringOps.scala:29)
	at edf.dataingestion.DataLoad$.getReplTime$1(DataLoad.scala:238)
	at edf.dataingestion.DataLoad$.run(DataLoad.scala:686)
	at edf.dataingestion.SparkJob$class.initiateAndRun$1(SparkJob.scala:23)
	at edf.dataingestion.SparkJob$class.main(SparkJob.scala:18)
	at edf.dataingestion.DataLoad$.main(DataLoad.scala:18)
	at edf.dataingestion.DataLoad.main(DataLoad.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:678)

	 ApplicationMaster host: ip-10-84-44-254.corp.stateauto.com
	 ApplicationMaster RPC port: 36567
	 queue: default
	 start time: 1568992221714
	 final status: FAILED
	 tracking URL: http://ip-10-84-38-68.corp.stateauto.com:20888/proxy/application_1567696628598_9406/
	 user: hadoop
19/09/20 15:12:23 ERROR Client: Application diagnostics message: User class threw exception: java.lang.NullPointerException
	at java.lang.String.compareTo(String.java:1155)
	at scala.collection.immutable.StringLike$class.compare(StringLike.scala:74)
	at scala.collection.immutable.StringOps.compare(StringOps.scala:29)
	at scala.collection.immutable.StringOps.compare(StringOps.scala:29)
	at scala.math.Ordered$class.$less$eq(Ordered.scala:84)
	at scala.collection.immutable.StringOps.$less$eq(StringOps.scala:29)
	at edf.dataingestion.DataLoad$.getReplTime$1(DataLoad.scala:238)
	at edf.dataingestion.DataLoad$.run(DataLoad.scala:686)
	at edf.dataingestion.SparkJob$class.initiateAndRun$1(SparkJob.scala:23)
	at edf.dataingestion.SparkJob$class.main(SparkJob.scala:18)
	at edf.dataingestion.DataLoad$.main(DataLoad.scala:18)
	at edf.dataingestion.DataLoad.main(DataLoad.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:678)

Exception in thread "main" org.apache.spark.SparkException: Application application_1567696628598_9406 finished with failed status
	at org.apache.spark.deploy.yarn.Client.run(Client.scala:1149)
	at org.apache.spark.deploy.yarn.YarnClusterApplication.start(Client.scala:1526)
	at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:849)
	at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:167)
	at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:195)
	at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:86)
	at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:924)
	at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:933)
	at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
19/09/20 15:12:23 INFO ShutdownHookManager: Shutdown hook called
19/09/20 15:12:23 INFO ShutdownHookManager: Deleting directory /mnt/tmp/spark-c6dccdd6-55bc-4e4d-84a5-764c2f6a4ebd
19/09/20 15:12:23 INFO ShutdownHookManager: Deleting directory /mnt/tmp/spark-4450ac76-0c2c-4373-afba-c997a37544dd
