19/09/20 13:36:18 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
19/09/20 13:36:19 INFO RMProxy: Connecting to ResourceManager at ip-10-84-38-68.corp.stateauto.com/10.84.38.68:8032
19/09/20 13:36:19 INFO Client: Requesting a new application from cluster with 6 NodeManagers
19/09/20 13:36:19 INFO Client: Verifying our application has not requested more than the maximum memory capability of the cluster (122880 MB per container)
19/09/20 13:36:19 INFO Client: Will allocate AM container, with 22528 MB memory including 2048 MB overhead
19/09/20 13:36:19 INFO Client: Setting up container launch context for our AM
19/09/20 13:36:19 INFO Client: Setting up the launch environment for our AM container
19/09/20 13:36:19 INFO Client: Preparing resources for our AM container
19/09/20 13:36:19 WARN Client: Neither spark.yarn.jars nor spark.yarn.archive is set, falling back to uploading libraries under SPARK_HOME.
19/09/20 13:36:22 INFO Client: Uploading resource file:/mnt/tmp/spark-f7ba4e64-00df-4596-a30d-7edac39ff4df/__spark_libs__731177130618157641.zip -> hdfs://ip-10-84-38-68.corp.stateauto.com:8020/user/hadoop/.sparkStaging/application_1567696628598_9404/__spark_libs__731177130618157641.zip
19/09/20 13:36:23 INFO Client: Uploading resource file:/home/hadoop/processed/jars/edf_dataingestion-assembly-2.0.0.jar -> hdfs://ip-10-84-38-68.corp.stateauto.com:8020/user/hadoop/.sparkStaging/application_1567696628598_9404/edf_dataingestion-assembly-2.0.0.jar
19/09/20 13:36:23 INFO Client: Uploading resource file:/home/hadoop/processed/ese/spec_files/ese_daily_DI.properties#diProperties.properties -> hdfs://ip-10-84-38-68.corp.stateauto.com:8020/user/hadoop/.sparkStaging/application_1567696628598_9404/ese_daily_DI.properties
19/09/20 13:36:23 INFO Client: Uploading resource file:/home/hadoop/processed/ese/spec_files/ese_lookup_info.csv#ese_lookup_info.csv -> hdfs://ip-10-84-38-68.corp.stateauto.com:8020/user/hadoop/.sparkStaging/application_1567696628598_9404/ese_lookup_info.csv
19/09/20 13:36:23 INFO Client: Uploading resource file:/home/hadoop/processed/ese/spec_files/ese_pii_spec.csv#ese_pii_spec.csv -> hdfs://ip-10-84-38-68.corp.stateauto.com:8020/user/hadoop/.sparkStaging/application_1567696628598_9404/ese_pii_spec.csv
19/09/20 13:36:23 INFO Client: Uploading resource file:/home/hadoop/processed/ese/spec_files/ese_table_spec_daily_DI.csv#ese_table_spec_daily_DI.csv -> hdfs://ip-10-84-38-68.corp.stateauto.com:8020/user/hadoop/.sparkStaging/application_1567696628598_9404/ese_table_spec_daily_DI.csv
19/09/20 13:36:23 INFO Client: Uploading resource file:/etc/spark/conf/hive-site.xml -> hdfs://ip-10-84-38-68.corp.stateauto.com:8020/user/hadoop/.sparkStaging/application_1567696628598_9404/hive-site.xml
19/09/20 13:36:23 INFO Client: Uploading resource file:/mnt/tmp/spark-f7ba4e64-00df-4596-a30d-7edac39ff4df/__spark_conf__3659163989425099128.zip -> hdfs://ip-10-84-38-68.corp.stateauto.com:8020/user/hadoop/.sparkStaging/application_1567696628598_9404/__spark_conf__.zip
19/09/20 13:36:23 INFO SecurityManager: Changing view acls to: hadoop
19/09/20 13:36:23 INFO SecurityManager: Changing modify acls to: hadoop
19/09/20 13:36:23 INFO SecurityManager: Changing view acls groups to: 
19/09/20 13:36:23 INFO SecurityManager: Changing modify acls groups to: 
19/09/20 13:36:23 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(hadoop); groups with view permissions: Set(); users  with modify permissions: Set(hadoop); groups with modify permissions: Set()
19/09/20 13:36:24 INFO Client: Submitting application application_1567696628598_9404 to ResourceManager
19/09/20 13:36:24 INFO YarnClientImpl: Submitted application application_1567696628598_9404
19/09/20 13:36:25 INFO Client: Application report for application_1567696628598_9404 (state: ACCEPTED)
19/09/20 13:36:25 INFO Client: 
	 client token: N/A
	 diagnostics: AM container is launched, waiting for AM container to Register with RM
	 ApplicationMaster host: N/A
	 ApplicationMaster RPC port: -1
	 queue: default
	 start time: 1568986584829
	 final status: UNDEFINED
	 tracking URL: http://ip-10-84-38-68.corp.stateauto.com:20888/proxy/application_1567696628598_9404/
	 user: hadoop
19/09/20 13:36:26 INFO Client: Application report for application_1567696628598_9404 (state: ACCEPTED)
19/09/20 13:36:27 INFO Client: Application report for application_1567696628598_9404 (state: ACCEPTED)
19/09/20 13:36:28 INFO Client: Application report for application_1567696628598_9404 (state: ACCEPTED)
19/09/20 13:36:29 INFO Client: Application report for application_1567696628598_9404 (state: ACCEPTED)
19/09/20 13:36:30 INFO Client: Application report for application_1567696628598_9404 (state: ACCEPTED)
19/09/20 13:36:31 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:31 INFO Client: 
	 client token: N/A
	 diagnostics: N/A
	 ApplicationMaster host: ip-10-84-34-237.corp.stateauto.com
	 ApplicationMaster RPC port: 45893
	 queue: default
	 start time: 1568986584829
	 final status: UNDEFINED
	 tracking URL: http://ip-10-84-38-68.corp.stateauto.com:20888/proxy/application_1567696628598_9404/
	 user: hadoop
19/09/20 13:36:32 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:33 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:34 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:35 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:36 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:37 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:38 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:39 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:40 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:41 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:42 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:43 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:44 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:45 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:46 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:47 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:48 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:49 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:50 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:51 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:52 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:53 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:54 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:55 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:56 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:57 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:58 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:36:59 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:00 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:01 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:02 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:03 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:04 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:05 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:06 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:07 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:08 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:09 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:10 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:11 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:12 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:13 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:14 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:15 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:16 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:17 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:18 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:19 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:20 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:21 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:22 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:23 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:24 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:25 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:26 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:27 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:28 INFO Client: Application report for application_1567696628598_9404 (state: ACCEPTED)
19/09/20 13:37:28 INFO Client: 
	 client token: N/A
	 diagnostics: AM container is launched, waiting for AM container to Register with RM
	 ApplicationMaster host: N/A
	 ApplicationMaster RPC port: -1
	 queue: default
	 start time: 1568986584829
	 final status: UNDEFINED
	 tracking URL: http://ip-10-84-38-68.corp.stateauto.com:20888/proxy/application_1567696628598_9404/
	 user: hadoop
19/09/20 13:37:29 INFO Client: Application report for application_1567696628598_9404 (state: ACCEPTED)
19/09/20 13:37:30 INFO Client: Application report for application_1567696628598_9404 (state: ACCEPTED)
19/09/20 13:37:31 INFO Client: Application report for application_1567696628598_9404 (state: ACCEPTED)
19/09/20 13:37:32 INFO Client: Application report for application_1567696628598_9404 (state: ACCEPTED)
19/09/20 13:37:33 INFO Client: Application report for application_1567696628598_9404 (state: ACCEPTED)
19/09/20 13:37:34 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:34 INFO Client: 
	 client token: N/A
	 diagnostics: N/A
	 ApplicationMaster host: ip-10-84-41-152.corp.stateauto.com
	 ApplicationMaster RPC port: 38883
	 queue: default
	 start time: 1568986584829
	 final status: UNDEFINED
	 tracking URL: http://ip-10-84-38-68.corp.stateauto.com:20888/proxy/application_1567696628598_9404/
	 user: hadoop
19/09/20 13:37:35 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:36 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:37 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:38 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:39 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:40 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:41 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:42 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:43 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:44 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:45 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:46 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:47 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:48 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:49 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:50 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:51 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:52 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:53 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:54 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:55 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:56 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:57 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:58 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:37:59 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:00 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:01 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:02 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:03 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:04 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:05 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:06 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:07 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:08 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:09 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:10 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:11 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:12 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:13 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:14 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:15 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:16 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:17 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:18 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:19 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:20 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:21 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:22 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:23 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:24 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:25 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:26 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:27 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:28 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:29 INFO Client: Application report for application_1567696628598_9404 (state: RUNNING)
19/09/20 13:38:30 INFO Client: Application report for application_1567696628598_9404 (state: FINISHED)
19/09/20 13:38:30 INFO Client: 
	 client token: N/A
	 diagnostics: User class threw exception: java.lang.NullPointerException
	at java.lang.String.compareTo(String.java:1155)
	at scala.collection.immutable.StringLike$class.compare(StringLike.scala:74)
	at scala.collection.immutable.StringOps.compare(StringOps.scala:29)
	at scala.collection.immutable.StringOps.compare(StringOps.scala:29)
	at scala.math.Ordered$class.$less$eq(Ordered.scala:84)
	at scala.collection.immutable.StringOps.$less$eq(StringOps.scala:29)
	at edf.dataingestion.DataLoad$.getReplTime$1(DataLoad.scala:238)
	at edf.dataingestion.DataLoad$.run(DataLoad.scala:686)
	at edf.dataingestion.SparkJob$class.initiateAndRun$1(SparkJob.scala:23)
	at edf.dataingestion.SparkJob$class.main(SparkJob.scala:18)
	at edf.dataingestion.DataLoad$.main(DataLoad.scala:18)
	at edf.dataingestion.DataLoad.main(DataLoad.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:678)

	 ApplicationMaster host: ip-10-84-41-152.corp.stateauto.com
	 ApplicationMaster RPC port: 38883
	 queue: default
	 start time: 1568986584829
	 final status: FAILED
	 tracking URL: http://ip-10-84-38-68.corp.stateauto.com:20888/proxy/application_1567696628598_9404/
	 user: hadoop
19/09/20 13:38:31 INFO Client: Deleted staging directory hdfs://ip-10-84-38-68.corp.stateauto.com:8020/user/hadoop/.sparkStaging/application_1567696628598_9404
19/09/20 13:38:31 ERROR Client: Application diagnostics message: User class threw exception: java.lang.NullPointerException
	at java.lang.String.compareTo(String.java:1155)
	at scala.collection.immutable.StringLike$class.compare(StringLike.scala:74)
	at scala.collection.immutable.StringOps.compare(StringOps.scala:29)
	at scala.collection.immutable.StringOps.compare(StringOps.scala:29)
	at scala.math.Ordered$class.$less$eq(Ordered.scala:84)
	at scala.collection.immutable.StringOps.$less$eq(StringOps.scala:29)
	at edf.dataingestion.DataLoad$.getReplTime$1(DataLoad.scala:238)
	at edf.dataingestion.DataLoad$.run(DataLoad.scala:686)
	at edf.dataingestion.SparkJob$class.initiateAndRun$1(SparkJob.scala:23)
	at edf.dataingestion.SparkJob$class.main(SparkJob.scala:18)
	at edf.dataingestion.DataLoad$.main(DataLoad.scala:18)
	at edf.dataingestion.DataLoad.main(DataLoad.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:678)

Exception in thread "main" org.apache.spark.SparkException: Application application_1567696628598_9404 finished with failed status
	at org.apache.spark.deploy.yarn.Client.run(Client.scala:1149)
	at org.apache.spark.deploy.yarn.YarnClusterApplication.start(Client.scala:1526)
	at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:849)
	at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:167)
	at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:195)
	at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:86)
	at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:924)
	at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:933)
	at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
19/09/20 13:38:31 INFO ShutdownHookManager: Shutdown hook called
19/09/20 13:38:31 INFO ShutdownHookManager: Deleting directory /mnt/tmp/spark-5ccfb748-860e-4fb4-913c-9a60819a5e06
19/09/20 13:38:31 INFO ShutdownHookManager: Deleting directory /mnt/tmp/spark-f7ba4e64-00df-4596-a30d-7edac39ff4df
